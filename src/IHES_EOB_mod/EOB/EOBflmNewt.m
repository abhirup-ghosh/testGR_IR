function Nlm = EOBflmNewt(x,nu, EOBopt)

%EOBFlmNewt Computes the GW multipolar flux for a binary in circular motion
%generic nu.  
%
%   fNewtlm = EOBflmNewt(x,nu, EOBopt) return Flm/nu^2
%

% TODO: this routine requires optimization
% - precompute coefficients c(nu)


LM2K = EOBopt.LM2K;

% Shorthands
nu2 = nu^2;
nu3 = nu^3;

x5  = x.^5;
x6  = x.^6;
x7  = x.^7;
x8  = x.^8;
x9  = x.^9;
x10 = x.^10;
x11 = x.^11;
x12 = x.^12;

sp2 = 1-4*nu;
sp3 = (1-3*nu)^2;
sp4 = (1-4*nu)*(1-2*nu)^2;
sp5 = (1-5*nu+5*nu2)^2;
sp6 = (1-4*nu)*(3*nu2-4*nu +1)^2;
sp7 = (1 - 7*nu + 14*nu2 - 7*nu3)^2;


% Newtonian partial fluxes
if nu~=0
    
    Nlm(LM2K(2,2),:) =   32/5        *       x5;
    Nlm(LM2K(2,1),:) =   8/45        * sp2 * x6;
    
    Nlm(LM2K(3,3),:) = 243/28        * sp2 * x6;
    Nlm(LM2K(3,2),:) = 32/63         * sp3 * x7;
    Nlm(LM2K(3,1),:) = 1/1260        * sp2 * x6;
    
    Nlm(LM2K(4,4),:) = 8192/567      * sp3 * x7;
    Nlm(LM2K(4,3),:) = 729/700       * sp4 * x8;
    Nlm(LM2K(4,2),:) = 32/3969       * sp3 * x7;
    Nlm(LM2K(4,1),:) = 1/44100       * sp4 * x8;
    
    Nlm(LM2K(5,5),:) = 1953125/76032 * sp4 * x8;
    Nlm(LM2K(5,4),:) = 131072/66825  * sp5 * x9;
    Nlm(LM2K(5,3),:) = 2187/70400    * sp4 * x8;
    Nlm(LM2K(5,2),:) = 256/400950    * sp5 * x9;
    Nlm(LM2K(5,1),:) = 1/19958400    * sp4 * x8;
    
    Nlm(LM2K(6,6),:) = 839808/17875             * sp5 * x9;
    Nlm(LM2K(6,5),:) = 48828125/13621608        * sp6 * x10;
    Nlm(LM2K(6,4),:) = 4194304/47779875         * sp5 * x9;
    Nlm(LM2K(6,3),:) = 59049/15415400           * sp6 * x10;
    Nlm(LM2K(6,2),:) = 128/28667925             * sp5 * x9;
    Nlm(LM2K(6,1),:) = 1/1123782660             * sp6 * x10;
    
    Nlm(LM2K(7,7),:) = 96889010407/1111968000   * sp6 * x10;
    Nlm(LM2K(7,6),:) = 5668704/875875           * sp7 * x11;
    Nlm(LM2K(7,5),:) = 1220703125/5.666588928e9 * sp6 * x10;
    Nlm(LM2K(7,4),:) = (4194304*(1 - 7*nu + 14*nu2 - 7*nu3)^2*x11)/3.07432125e8;
    Nlm(LM2K(7,3),:) = (1594323*(1 - 4*nu)*(1 - 4*nu + 3*nu2)^2*x10)/3.2064032e10;
    Nlm(LM2K(7,2),:) = (32*(1 - 7*nu + 14*nu2 - 7*nu3)^2*x11)/1.35270135e8;
    Nlm(LM2K(7,1),:) = ((1 - 4*nu)*(1 - 4*nu + 3*nu2)^2*x10)/9.3498717312e11;
    
    Nlm(LM2K(8,8),:) = (7*nu3-14*nu2+7*nu-1)^2*274877906944/1688511825*x11;
    Nlm(LM2K(8,7),:) = (4747561509943*(1 - 4*nu)*(1 - 6*nu + 10*nu2 - 4*nu3)^2*x12)/4.083146496e11;
    Nlm(LM2K(8,6),:) = (51018336*(1 - 7*nu + 14*nu2 - 7*nu3)^2*x11)/1.04229125e8;
    Nlm(LM2K(8,5),:) = (30517578125*(1 - 4*nu)*(1 - 6*nu + 10*nu2 - 4*nu3)^2*x12)/8.00296713216e11;
    Nlm(LM2K(8,4),:) = (4194304*(1 - 7*nu + 14*nu2 - 7*nu3)^2*x11)/1.5679038375e10;
    Nlm(LM2K(8,3),:) = (177147*(1 - 4*nu)*(1 - 6*nu + 10*nu2 - 4*nu3)^2*x12)/3.96428032e10;
    Nlm(LM2K(8,2),:) = (32*(1 - 7*nu + 14*nu2 - 7*nu3)^2*x11)/3.4493884425e10;
    Nlm(LM2K(8,1),:) = ((1 - 4*nu)*(1 - 6*nu + 10*nu2 - 4*nu3)^2*x12)/8.174459284992e13;
    
else
    
    Nlm(LM2K(2,2),:) = x5* 32.d0/5.d0;
    Nlm(LM2K(2,1),:) = x6* 8.d0/45.d0;
    
    Nlm(LM2K(3,3),:) = x6* 243.d0/28.d0;
    Nlm(LM2K(3,2),:) = x7* 32.d0/63.d0;
    Nlm(LM2K(3,1),:) = x6/ 1260.d0;
    
    Nlm(LM2K(4,4),:) = x7* 8192.d0/567.d0;
    Nlm(LM2K(4,3),:) = x8* 729.d0/700.d0;
    Nlm(LM2K(4,2),:) = x7* 32.d0/3969.d0;
    Nlm(LM2K(4,1),:) = x8/ 44100.d0;
    
    Nlm(LM2K(5,5),:) = x8* 1953125.d0/76032.d0;
    Nlm(LM2K(5,4),:) = x9* 131072.d0/66825.d0;
    Nlm(LM2K(5,3),:) = x8* 2187.d0/70400.d0;
    Nlm(LM2K(5,2),:) = x9* 256.d0/400950.d0;
    Nlm(LM2K(5,1),:) = x8/ 19958400.d0;
    
    Nlm(LM2K(6,6),:) = x9* 839808.d0/17875.d0;
    Nlm(LM2K(6,5),:) = x10* 48828125.d0/13621608.d0;
    Nlm(LM2K(6,4),:) = x9* 4194304.d0/47779875.d0;
    Nlm(LM2K(6,3),:) = x10* 59049.d0/15415400.d0;
    Nlm(LM2K(6,2),:) = x9* 128.d0/28667925.d0;
    Nlm(LM2K(6,1),:) = x10/ 1123782660.d0;
    
    Nlm(LM2K(7,7),:) = x10* 96889010407.d0/1111968000.d0;
    Nlm(LM2K(7,6),:) = x11* 5668704.d0/875875.d0;
    Nlm(LM2K(7,5),:) = x10* 1220703125.d0/5.666588928d9;
    Nlm(LM2K(7,4),:) = x11* 4194304.d0/3.07432125d8;
    Nlm(LM2K(7,3),:) = x10* 1594323.d0/3.2064032d10;
    Nlm(LM2K(7,2),:) = x11* 32.d0/1.35270135d8;
    Nlm(LM2K(7,1),:) = x10/ 9.3498717312d11;
    
    Nlm(LM2K(8,8),:) = x11* 274877906944.d0/1688511825.d0;
    Nlm(LM2K(8,7),:) = x12* 4747561509943.d0/4.083146496d11;
    Nlm(LM2K(8,6),:) = x11* 51018336.d0/1.04229125d8;
    Nlm(LM2K(8,5),:) = x12* 30517578125.d0/8.00296713216d11;
    Nlm(LM2K(8,4),:) = x11* 4194304.d0/1.5679038375d10;
    Nlm(LM2K(8,3),:) = x12* 177147.d0/3.96428032d10;
    Nlm(LM2K(8,2),:) = x11* 32.d0/3.4493884425d10;
    Nlm(LM2K(8,1),:) = x12/ 8.174459284992d13;
    
end
