<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of FDdrvt</title>
  <meta name="keywords" content="FDdrvt">
  <meta name="description" content="FDdrvt Compute finite differences of the function f(t).">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">EOB</a> &gt; FDdrvt.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for EOB&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>FDdrvt
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>FDdrvt Compute finite differences of the function f(t).</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [d1f, d2f] = FDdrvt(f,t, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">FDdrvt Compute finite differences of the function f(t).

   [d1f, d2f] = FDdrvt(f,t) compute finte differences of f(t) 

   [d1f, d2f] = FDdrvt(f,t, order) specify order, a negative order uses
   expressions for data non uniformly sampled (only 1st derivative
   implemented at the moment)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="FDdrvt.html" class="code" title="function [d1f, d2f] = FDdrvt(f,t, varargin)">FDdrvt</a>	FDdrvt Compute finite differences of the function f(t).</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="EOBExtractAPO.html" class="code" title="function varargout = EOBExtractAPO(hlm,t)">EOBExtractAPO</a>	EOBExtractAPO Compute amplitude, phase and frequency of waveform.</li><li><a href="EOBIdPostAdiab.html" class="code" title="function y0 = EOBIdPostAdiab( nu, r0, EOBopt )">EOBIdPostAdiab</a>	EOBIdPostAdiab Provides initial data in post-post-circular approximation for</li><li><a href="EOBIdPostAdiab_mod.html" class="code" title="function y0 = EOBIdPostAdiab_mod( nu, r0, EOBopt )">EOBIdPostAdiab_mod</a>	EOBIdPostAdiab Provides initial data in post-post-circular approximation for</li><li><a href="EOBNQCabFind.html" class="code" title="function [a,b] = EOBNQCabFind( t,Omega,n,Alm,omglm,domglm,d2omglm, NRPTS )">EOBNQCabFind</a>	EOBNQCabFind Compute a's and b's</li><li><a href="EOBRun.html" class="code" title="function varargout = EOBRun( nu,ainput, ... % a1,a2,a3,a4,a5,a6 (rem: a1...a4 multipolar!)">EOBRun</a>	</li><li><a href="EOBRun_DIN_mod.html" class="code" title="function varargout = EOBRun_DIN_mod( nu,ainput, ... % a1,a2,a3,a4,a5,a6 (rem: a1...a4 multipolar!)">EOBRun_DIN_mod</a>	</li><li><a href="EOBRun_insplunge_ringdown.html" class="code" title="function varargout = EOBRun_insplunge_ringdown( nu,ainput, ... % a1,a2,a3,a4,a5,a6 (rem: a1...a4 multipolar!)">EOBRun_insplunge_ringdown</a>	</li><li><a href="FDdrvt.html" class="code" title="function [d1f, d2f] = FDdrvt(f,t, varargin)">FDdrvt</a>	FDdrvt Compute finite differences of the function f(t).</li><li><a href="T4Run.html" class="code" title="function varargout = T4Run(q,r0,Phi0,dt,tmax, varargin)">T4Run</a>	T4Run Taylor-T4 approximant.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [d1f, d2f] = FDdrvt(f,t, varargin)</a>
0002 
0003 <span class="comment">%FDdrvt Compute finite differences of the function f(t).</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   [d1f, d2f] = FDdrvt(f,t) compute finte differences of f(t)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   [d1f, d2f] = FDdrvt(f,t, order) specify order, a negative order uses</span>
0008 <span class="comment">%   expressions for data non uniformly sampled (only 1st derivative</span>
0009 <span class="comment">%   implemented at the moment)</span>
0010 <span class="comment">%</span>
0011 
0012 <span class="comment">% Manage args in</span>
0013 order   = 2;  <span class="comment">% order</span>
0014 optargs = {order};
0015 na = length(varargin);
0016 <span class="keyword">if</span> (na&gt;1), error(<span class="string">'too many input args'</span>); <span class="keyword">end</span>
0017 newvals = cellfun(@(x) ~isempty(x), varargin);
0018 optargs(newvals) = varargin(newvals);
0019 [order] = optargs{:};
0020 
0021 n     = length(t);
0022 
0023 <span class="comment">% check for uniform spacing</span>
0024 <span class="comment">%FIXME: better way?</span>
0025 <span class="keyword">if</span> ( all(diff(diff(t))) )
0026     order = - order;
0027 <span class="keyword">else</span>
0028     dt    = t(2)-t(1);
0029     oodt  = 1./dt;   
0030     oodt2 = oodt^2;        
0031 <span class="keyword">end</span>
0032  
0033 t   = reshape(t,size(f));
0034 df  = 0*f;
0035 d2f = 0*f;
0036 
0037 <span class="keyword">switch</span> order
0038   
0039  <span class="keyword">case</span> 2
0040   
0041   i = 2:n-1;
0042   d1f(i) =  (f(i+1)-f(i-1))*0.5*oodt;
0043   d2f(i) =  (f(i+1) - 2*f(i) + f(i-1))*oodt2;
0044   
0045   i = 1;
0046   d1f(i) = -(3*f(i)-4*f(i+1)+f(i+2))*0.5*oodt;
0047   d2f(i) =  (2*f(i)-5*f(i+1)+4*f(i+2)-f(i+3))*oodt2;
0048   
0049   i = n;
0050   d1f(i) =  (3*f(i)-4*f(i-1)+f(i-2))*0.5*oodt;
0051   d2f(i) =  (2*f(i)-5*f(i-1)+4*f(i-2)-f(i-3))*oodt2;
0052    
0053  <span class="keyword">case</span> 4 
0054   
0055   c = 1/12;
0056 
0057   i = 3:n-2;
0058   d1f(i) = c*(8*(f(i+1)-f(i-1)) - f(i+2) + f(i-2))*oodt;
0059   d2f(i) = c*(-30*f(i)+16*(f(i+1)+f(i-1))-(f(i+2)+f(i-2)))*oodt2;
0060   
0061   i = 1;
0062   d1f(i) = c*(-25*f(i)+48*f(i+1)-36*f(i+2)+16*f(i+3)-3*f(i+4))*oodt;
0063   d2f(i) = c*(45*f(i)-154*f(i+1)+214*f(i+2)-156*f(i+3)+61*f(i+4)-10*f(i+5))*oodt2;
0064   
0065   i = 2;
0066   d1f(i) = c*(-3*f(i-1)-10*f(i)+18*f(i+1)-6*f(i+2)+f(i+3))*oodt;
0067   d2f(i) = c*(10*f(i-1)-15*f(i)-4*f(i+1)+14*f(i+2)-6*f(i+3)+f(i+4))*oodt2;
0068   
0069   i = n-1;
0070   d1f(i) = - c*(-3*f(i+1)-10*f(i)+18*f(i-1)-6*f(i-2)+f(i-3))*oodt;
0071   d2f(i) = c*(10*f(i+1)-15*f(i)-4*f(i-1)+14*f(i-2)-6*f(i-3)+f(i-4))*oodt2;
0072   
0073   i = n;
0074   d1f(i) = - c*(-25*f(i)+48*f(i-1)-36*f(i-2)+16*f(i-3)-3*f(i-4))*oodt;
0075   d2f(i) = c*(45*f(i)-154*f(i-1)+214*f(i-2)-156*f(i-3)+61*f(i-4)-10*f(i-5))*oodt2;
0076     
0077  <span class="keyword">case</span> -2
0078      
0079   <span class="comment">%FIXME: 2nd drvt</span>
0080   <span class="keyword">if</span> nargout&gt;1
0081     warning(<span class="string">'vectors are non-uniformly spaced, 2nd derivate not implemented yet'</span>);
0082   <span class="keyword">end</span>
0083   
0084   i = 2:n-1;      
0085   df(i) = (f(i+1)-f(i-1))/(t(i+1)-t(i-1));
0086     
0087   i = 1;
0088   d1f(i) = -(3*f(i)-4*f(i+1)+f(i+2))./(t(i+2)-t(i));
0089   
0090   i = n;
0091   d1f(i) =  (3*f(i)-4*f(i-1)+f(i-2))./(t(i)-t(i-2));  
0092   
0093  <span class="keyword">case</span> -4    
0094      
0095   <span class="comment">%FIXME: 2nd drvt</span>
0096   <span class="keyword">if</span> nargout&gt;1
0097     warning(<span class="string">'vectors are non-uniformly spaced, 2nd derivate not implemented yet'</span>);
0098   <span class="keyword">end</span>
0099   
0100   c = 1/3;   
0101      
0102   i = 3:n-2;
0103   d1f(i) = c*(8*(f(i+1)-f(i-1)) - f(i+2) + f(i-2))./(t(i+2)-t(i-2));
0104     
0105   <span class="comment">%FIXME: the following expressions need fixing:</span>
0106   i = 1; 
0107   d1f(i) = c*(-25*f(i)+48*f(i+1)-36*f(i+2)+16*f(i+3)-3*f(i+4))./(t(i+4)-t(i));
0108   
0109   i = 2;
0110   d1f(i) = c*(-3*f(i-1)-10*f(i)+18*f(i+1)-6*f(i+2)+f(i+3))./(t(i+3)-t(i-1));
0111   
0112   i = n-1;
0113   d1f(i) = - c*(-3*f(i+1)-10*f(i)+18*f(i-1)-6*f(i-2)+f(i-3))./(t(i+1)-t(i-3));
0114   
0115   i = n;
0116   d1f(i) = - c*(-25*f(i)+48*f(i-1)-36*f(i-2)+16*f(i-3)-3*f(i-4))./(t(i)-t(i-4));    
0117     
0118  <span class="keyword">otherwise</span>
0119   error(<span class="string">' order not implemented'</span>)
0120 <span class="keyword">end</span>
0121 
0122 
0123 
0124 <span class="comment">%{</span>
0125 <span class="comment">% test</span>
0126 x=0:0.01:2*pi;f=sin(x);
0127 [df1,df2] = <a href="FDdrvt.html" class="code" title="function [d1f, d2f] = FDdrvt(f,t, varargin)">FDdrvt</a>(f,x,2); plot(x,f,x,cos(x),x,df1,x,-df2)
0128 [df1,df2] = <a href="FDdrvt.html" class="code" title="function [d1f, d2f] = FDdrvt(f,t, varargin)">FDdrvt</a>(f,x,4); plot(x,f,x,cos(x),x,df1,x,-df2)
0129 <span class="comment">%}</span></pre></div>
<hr><address>Generated on Fri 25-Sep-2015 16:20:46 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>