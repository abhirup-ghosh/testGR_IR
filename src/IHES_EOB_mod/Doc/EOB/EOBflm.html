<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of EOBflm</title>
  <meta name="keywords" content="EOBflm">
  <meta name="description" content="EOBflm Compute the resummed amplitudes in the general nu-dependent case.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">EOB</a> &gt; EOBflm.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for EOB&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>EOBflm
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>EOBflm Compute the resummed amplitudes in the general nu-dependent case.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [flm, rholm] = EOBflm(x,nu, EOBopt) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">EOBflm Compute the resummed amplitudes in the general nu-dependent case.


   [flm, rholm] = EOBflm(x,nu, EOBopt)

        x   :: PN parameter
        nu  :: symmetric mass ratio. EMRL case is nu=0
        eps :: eps=1 switches on Iyer-Fujita terms; eps=0 switches them off.

   Reference(s)
   Damour, Iyer &amp; Nagar, PRD 79, 064004 (2009)     [theory]
   Fujita &amp; Iyer, PRD 82, 044051 (2010)            [test-mass 5.5PN]
   Damour, Nagar &amp; Bernuzzi, PRD 87, 084035 (2013) [complete information]</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>	EULERLOG Compute Eulerlog function.</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="EOBFluxDIN.html" class="code" title="function [hatF Flm FNewtlm flm] =EOBFluxDIN(x,Omega,E,Heff,jhat,nu,r,prstar,ddotr, EOBopt)">EOBFluxDIN</a>	EOBFluxDIN Computes the resummed Newton-normalized GW energy flux.</li><li><a href="EOBFluxDIN_mod.html" class="code" title="function [hatF Flm FNewtlm flm] =EOBFluxDIN_mod(x,Omega,E,Heff,jhat,nu,r,prstar,ddotr, EOBopt)">EOBFluxDIN_mod</a>	EOBFluxDIN Computes the resummed Newton-normalized GW energy flux.</li><li><a href="EOBhlm.html" class="code" title="function varargout = EOBhlm(nu, t,phi,r,pph,prstar, Omega,E,Heff, EOBopt, EOBmet)">EOBhlm</a>	EOBhlm Compute the multipolar resummed waveform.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001     <a name="_sub0" href="#_subfunctions" class="code">function [flm, rholm] = EOBflm(x,nu, EOBopt)</a>
0002 
0003 <span class="comment">%EOBflm Compute the resummed amplitudes in the general nu-dependent case.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%   [flm, rholm] = EOBflm(x,nu, EOBopt)</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%        x   :: PN parameter</span>
0009 <span class="comment">%        nu  :: symmetric mass ratio. EMRL case is nu=0</span>
0010 <span class="comment">%        eps :: eps=1 switches on Iyer-Fujita terms; eps=0 switches them off.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   Reference(s)</span>
0013 <span class="comment">%   Damour, Iyer &amp; Nagar, PRD 79, 064004 (2009)     [theory]</span>
0014 <span class="comment">%   Fujita &amp; Iyer, PRD 82, 044051 (2010)            [test-mass 5.5PN]</span>
0015 <span class="comment">%   Damour, Nagar &amp; Bernuzzi, PRD 87, 084035 (2013) [complete information]</span>
0016 
0017 <span class="comment">% TODO: this routine requires optimization</span>
0018 <span class="comment">% - precompute coefficients c(nu)</span>
0019 <span class="comment">% - evaluate efficiently polynomials</span>
0020 <span class="comment">% - How does Matlab deal with 1 + small ? (add 1 later?)</span>
0021 
0022 
0023 LM2K = EOBopt.LM2K;
0024 L    = EOBopt.L;
0025 eps  = strcmp(EOBopt.FIterms,<span class="string">'yes'</span>);
0026 
0027 
0028 <span class="comment">% Shorthands</span>
0029 x2  = x.^2;
0030 x3  = x.^3;
0031 x4  = x.^4;
0032 x5  = x.^5;
0033 nu2 = nu^2;
0034 nu3 = nu^3;
0035 nu4 = nu^4;
0036 
0037 
0038 <span class="comment">% Compute EulerLogs</span>
0039 el1 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,1);
0040 el2 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,2);
0041 el3 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,3);
0042 el4 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,4);
0043 el5 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,5);
0044 el6 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,6);
0045 el7 = <a href="Eulerlog.html" class="code" title="function y = Eulerlog(x,m)">Eulerlog</a>(x,7);
0046 
0047 
0048 <span class="comment">% Compute rho_{lm}</span>
0049 kmax  = length(L);
0050 rholm = zeros(kmax,length(x));
0051 flm   = rholm;
0052 
0053 
0054 <span class="comment">% l=2 ------------------------------------------------------------------</span>
0055 
0056 rholm(LM2K(2,2),:) = 1. + (-1.0238095238095237 + 0.6547619047619048*nu)*x + (-1.94208238851096 - 1.5601379440665155*nu + 0.4625614134542706*nu2)*x2<span class="keyword">...</span>
0057     + x3.*(12.736034731834051 - 2.902228713904598*nu - 1.9301558466099282*nu2 + 0.2715020968103451*nu3 - 4.076190476190476*el2)<span class="keyword">...</span>
0058     + x4.*(-2.4172313935587004 + 4.173242630385488*el2)<span class="keyword">...</span>
0059     + x5.*(-30.14143102836864 + 7.916297736025627*el2);
0060                      
0061 rholm(LM2K(2,1),:) = 1. + (-1.0535714285714286 + 0.27380952380952384*nu)*x <span class="keyword">...</span>
0062     + (-0.8327841553287982 - 0.7789824263038548*nu + 0.13116496598639457*nu2)*x2 <span class="keyword">...</span>
0063     + x3.*(2.9192806270460925 - 1.019047619047619*el1) <span class="keyword">...</span>
0064     + x4.*(-1.28235780892213 + 1.073639455782313*el1)<span class="keyword">...</span>
0065     + eps*x5.*(-3.8466571723355227 + 0.8486467106683944*el1);
0066 
0067 
0068 <span class="comment">% l=3 ------------------------------------------------------------------</span>
0069 
0070 rholm(LM2K(3,3),:) = 1. + (-1.1666666666666667 + 0.6666666666666666*nu)*x + (-1.6967171717171716 - 1.8797979797979798*nu + 0.45151515151515154*nu2)*x2 <span class="keyword">...</span>
0071     + x3.*(14.10891386831863 - 3.7142857142857144*el3) + x4.*(-6.723375314944128 + 4.333333333333333*el3) <span class="keyword">...</span>
0072     + eps*x5.*(-29.568699895427518 + 6.302092352092352*el3);
0073 
0074 rholm(LM2K(3,2),:) = 1. + (0.003703703703703704*(328. - 1115.*nu + 320.*nu2)*x)./(-1. + 3.*nu)<span class="keyword">...</span>
0075     + (6.235191420376606e-7*(-1.444528e6 + 8.050045e6*nu - 4.725605e6*nu2 - 2.033896e7*nu3 + 3.08564e6*nu4)*x2)./power(-1. + 3.*nu,2) <span class="keyword">...</span>
0076     + x3.*(6.220997955214429 - 1.6507936507936507*el2) <span class="keyword">...</span>
0077     + eps*x4.*(-3.4527288879001268 + 2.005408583186361*el2);
0078 
0079 rholm(LM2K(3,1),:) = 1. + (-0.7222222222222222 - 0.2222222222222222*nu)*x + (0.014169472502805836 - 0.9455667789001122*nu - 0.46520763187429853*nu2)*x2 <span class="keyword">...</span>
0080     + x3.*(1.9098284139598072 - 0.4126984126984127*el1)<span class="keyword">...</span>
0081     + x4.*(0.5368150316615179 + 0.2980599647266314*el1)<span class="keyword">...</span>
0082     + eps*x5.*(1.4497991763035063 - 0.0058477188106817735*el1);
0083 
0084 
0085 <span class="comment">% l=4 ------------------------------------------------------------------</span>
0086 
0087 rholm(LM2K(4,4),:) = 1. + (0.0007575757575757576*(1614. - 5870.*nu + 2625.*nu2)*x)./(-1. + 3.*nu) <span class="keyword">...</span>
0088     + (3.1534122443213353e-9*(-5.11573572e8 + 2.338945704e9*nu - 3.13857376e8*nu2 - 6.733146e9*nu3 + 1.252563795e9*nu4)*x2)/power(-1. + 3.*nu,2)<span class="keyword">...</span>
0089     + x3.*(15.108111214795123 - 3.627128427128427*el4)<span class="keyword">...</span>
0090     + eps*x4.*(-8.857121657199649 + 4.434988849534304*el4);
0091 
0092 rholm(LM2K(4,3),:) = 1. + (0.005681818181818182*(222. - 547.*nu + 160.*nu2)*x)./(-1. + 2.*nu) - 0.9783218202252293*x2 <span class="keyword">...</span>
0093     + eps*(x3.*(8.519456157072423 - 2.0402597402597404*el3) <span class="keyword">...</span>
0094     +      x4.*(-5.353216984886716 + 2.5735094451003544*el3));
0095 
0096 rholm(LM2K(4,2),:) = 1. + (0.0007575757575757576*(1146. - 3530.*nu + 285.*nu2)*x)./(-1. + 3.*nu) <span class="keyword">...</span>
0097     - (3.1534122443213353e-9*(1.14859044e8 - 2.95834536e8*nu - 1.204388696e9*nu2 + 3.04798116e9*nu3 + 3.79526805e8*nu4)*x2)/power(-1. + 3.*nu,2)<span class="keyword">...</span>
0098     + 4.550378418934105e-12*x3.*(8.48238724511e11 - 1.9927619712e11*el2) <span class="keyword">...</span>
0099     + eps*x4.*(-0.6621921297263365 + 0.787251738160829*el2);
0100 
0101 rholm(LM2K(4,1),:) = 1. + (0.001893939393939394*(602. - 1385.*nu + 288.*nu2)*x)./(-1. + 2.*nu) - 0.36778992787515513*x2 <span class="keyword">...</span>
0102     + x3.*(0.6981550175535535 - 0.2266955266955267*el1) <span class="keyword">...</span>
0103     + eps*x4.*(-0.7931524512893319 + 0.2584672482399755*el1);
0104 
0105 
0106 <span class="comment">% l=5 ------------------------------------------------------------------</span>
0107 
0108 rholm(LM2K(5,5),:) = 1. + (0.002564102564102564*(487. - 1298.*nu + 512.*nu2)*x)./(-1. + 2.*nu) - 1.5749727622804546*x2 <span class="keyword">...</span>
0109     + eps*(x3.*(15.939827047208668 - 3.6037296037296036*el5) <span class="keyword">...</span>
0110     +      x4.*(-10.272578060123237 + 4.500041838503377*el5));
0111 
0112 rholm(LM2K(5,4),:) = 1. + (0.00007326007326007326*(-17448. + 96019.*nu - 127610.*nu2 + 33320.*nu3)*x)./(1. - 5.*nu + 5.*nu2) <span class="keyword">...</span>
0113     + eps*(- 1.0442142414362194*x2 <span class="keyword">...</span>
0114     +   x3.*(10.252052781721588 - 2.3063869463869464*el4));
0115 
0116 rholm(LM2K(5,3),:) = 1. + (0.002564102564102564*(375. - 850.*nu + 176.*nu2)*x)./(-1. + 2.*nu) - 0.5788010707241477*x2 <span class="keyword">...</span>
0117     + eps*(x3.*(5.733973288504755 - 1.2973426573426574*el3) <span class="keyword">...</span>
0118     +      x4.*(-1.9573287625526001 + 1.2474448628294783*el3));
0119 
0120 rholm(LM2K(5,2),:) = 1. + (0.00007326007326007326*(-15828. + 84679.*nu - 104930.*nu2 + 21980.*nu3)*x)./(1. - 5.*nu + 5.*nu2) <span class="keyword">...</span>
0121     + eps*(- 0.4629337197600934*x2 <span class="keyword">...</span>
0122     +      x3.*(2.354458371550237 - 0.5765967365967366*el2));
0123 
0124 rholm(LM2K(5,1),:) = 1. + (0.002564102564102564*(319. - 626.*nu + 8.*nu2)*x)./(-1. + 2.*nu) - 0.1047896120973044*x2 <span class="keyword">...</span>
0125     + eps*(x3.*(0.642701885362399 - 0.14414918414918415*el1) <span class="keyword">...</span>
0126     +      x4.*(-0.07651588046467575 + 0.11790664036817883*el1));
0127 
0128 
0129 <span class="comment">% l=6 ------------------------------------------------------------------</span>
0130 
0131 rholm(LM2K(6,6),:) = 1. + (0.011904761904761904*(-106. + 602.*nu - 861.*nu2 + 273.*nu3)*x)./(1. - 5.*nu + 5.*nu2) <span class="keyword">...</span>
0132     + eps*(- 1.5543111183867486*x2 + x3.*(16.645950799433503 - 3.6003996003996006*el6));
0133 
0134 rholm(LM2K(6,5),:) = 1. + (0.006944444444444444*(-185. + 838.*nu - 910.*nu2 + 220.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0135     + eps*(- 1.0973940686333457*x2 + x3.*(11.623366217471297 - 2.5002775002775004*el5));
0136 
0137 rholm(LM2K(6,4),:) = 1. + (0.011904761904761904*(-86. + 462.*nu - 581.*nu2 + 133.*nu3)*x)./(1. - 5.*nu + 5.*nu2) <span class="keyword">...</span>
0138     + eps*(- 0.7228451986855349*x2 + x3.*(7.359388663371044 - 1.6001776001776002*el4));
0139 
0140 rholm(LM2K(6,3),:) = 1. + (0.006944444444444444*(-169. + 742.*nu - 750.*nu2 + 156.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0141     + eps*(- 0.5605554442947213*x2 + x3.*(4.002558222882566 - 0.9000999000999002*el3));
0142 
0143 rholm(LM2K(6,2),:) = 1. + (0.011904761904761904*(-74. + 378.*nu - 413.*nu2 + 49.*nu3)*x)./(1. - 5.*nu + 5.*nu2)<span class="keyword">...</span>
0144     + eps*( - 0.24797525070634313*x2 + x3.*(1.7942694138754138 - 0.40004440004440006*el2));
0145 
0146 rholm(LM2K(6,1),:) = 1. + (0.006944444444444444*(-161. + 694.*nu - 670.*nu2 + 124.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0147     + eps*(- 0.29175486850885135*x2 + x3.*(0.21653486654395454 - 0.10001110001110002*el1));
0148 
0149 
0150 <span class="comment">% l=7 ------------------------------------------------------------------</span>
0151 
0152 rholm(LM2K(7,7),:) = 1. + (0.0014005602240896359*(-906. + 4246.*nu - 4963.*nu2 + 1380.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0153     + eps*(- 1.5418467934923434*x2 + x3.*(17.255875091408523 - 3.6042232277526396*el7));
0154 
0155 rholm(LM2K(7,6),:) = 1. + (0.0006002400960384153*(2144. - 16185.*nu + 37828.*nu2 - 29351.*nu3 + 6104.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3) <span class="keyword">...</span>
0156     - 1.1403265020692532*eps*x2;
0157 
0158 rholm(LM2K(7,5),:) = 1. + (0.0014005602240896359*(-762. + 3382.*nu - 3523.*nu2 + 804.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0159     + eps*(- 0.8269193364414116*x2 + x3.*(8.750589067052443 - 1.838889401914612*el5));
0160 
0161 rholm(LM2K(7,4),:) = 1. + (0.00006669334400426837*(17756. - 131805.*nu + 298872.*nu2 - 217959.*nu3 + 41076.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0162     - 0.6473746896670599*eps*x2;
0163 
0164 rholm(LM2K(7,3),:) = 1. + (0.0014005602240896359*(-666. + 2806.*nu - 2563.*nu2 + 420.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0165     + eps*(- 0.37187416047628863*x2 + x3.*(3.0835293524055283 - 0.6620001846892604*el3));
0166 
0167 rholm(LM2K(7,2),:) = 1. + (0.00006669334400426837*(16832. - 123489.*nu + 273924.*nu2 - 190239.*nu3 + 32760.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0168     - 0.351319484450667*eps*x2;
0169 
0170 rholm(LM2K(7,1),:) = 1. + (0.0014005602240896359*(-618. + 2518.*nu - 2083.*nu2 + 228.*nu3)*x)./(1. - 4.*nu + 3.*nu2) <span class="keyword">...</span>
0171     + eps*( - 0.1508235111143767*x2 + x3.*(0.2581280702019663 - 0.07355557607658449*el1));
0172 
0173 
0174 <span class="comment">% l=8 ------------------------------------------------------------------</span>
0175 
0176 rholm(LM2K(8,8),:) = 1. + (0.0003654970760233918*(3482. - 26778.*nu + 64659.*nu2 - 53445.*nu3 + 12243.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0177     - 1.5337092502821381*eps*x2;
0178 
0179 rholm(LM2K(8,7),:) = 1. + (0.00005482456140350877*(23478. - 154099.*nu + 309498.*nu2 - 207550.*nu3 + 38920.*nu4)*x)./(-1. + 6.*nu - 10.*nu2 + 4.*nu3)<span class="keyword">...</span>
0180     - 1.175404252991305*eps*x2;
0181 
0182 rholm(LM2K(8,6),:) = 1. + (0.0010964912280701754*(1002. - 7498.*nu + 17269.*nu2 - 13055.*nu3 + 2653.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0183     - 0.9061610303170207*eps*x2;
0184 
0185 rholm(LM2K(8,5),:) = 1. + (0.00027412280701754384*(4350. - 28055.*nu + 54642.*nu2 - 34598.*nu3 + 6056.*nu4)*x)./(-1. + 6.*nu - 10.*nu2 + 4.*nu3)<span class="keyword">...</span>
0186     - 0.7220789990670207*eps*x2;
0187 
0188 rholm(LM2K(8,4),:) = 1. + (0.0003654970760233918*(2666. - 19434.*nu + 42627.*nu2 - 28965.*nu3 + 4899.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0189     - 0.47652059150068155*eps*x2;
0190 
0191 rholm(LM2K(8,3),:) = 1. + (0.00005482456140350877*(20598. - 131059.*nu + 249018.*nu2 - 149950.*nu3 + 24520.*nu4)*x)./(-1. + 6.*nu - 10.*nu2 + 4.*nu3)<span class="keyword">...</span>
0192     - 0.4196774909106648*eps*x2;
0193 
0194 rholm(LM2K(8,2),:) = 1. + (0.0003654970760233918*(2462. - 17598.*nu + 37119.*nu2 - 22845.*nu3 + 3063.*nu4)*x)./(-1. + 7.*nu - 14.*nu2 + 7.*nu3)<span class="keyword">...</span>
0195     - 0.2261796441029474*eps*x2;
0196 
0197 rholm(LM2K(8,1),:) = 1. + (0.00005482456140350877*(20022. - 126451.*nu + 236922.*nu2 - 138430.*nu3 + 21640.*nu4)*x)./(-1. + 6.*nu - 10.*nu2 + 4.*nu3)<span class="keyword">...</span>
0198     - 0.26842133517043704*eps*x2;
0199 
0200 
0201 <span class="comment">% Compute the f_lm = rho_lm^l</span>
0202 <span class="comment">%pL  = repmat(L',1,length(x));</span>
0203 <span class="comment">%flm = rholm.^pL;</span>
0204 <span class="keyword">for</span> k=1:kmax
0205     flm(k,:) = rholm(k,:).^L(k);
0206 <span class="keyword">end</span>
0207 
0208 <span class="comment">% TEST: make parallel these loops?</span>
0209 <span class="comment">%matlabpool</span>
0210 <span class="comment">%parfor k=1:kmax</span>
0211 <span class="comment">%    flm(k,:) = rholm(k,:).^L(k);</span>
0212 <span class="comment">%end</span>
0213 
0214 
0215 
0216 
0217 
0218 
0219 
0220</pre></div>
<hr><address>Generated on Fri 25-Sep-2015 16:20:46 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>