<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of T4Wav</title>
  <meta name="keywords" content="T4Wav">
  <meta name="description" content="T4Wav Taylor-T4 waveform at 2.5 or 3.0 PN accuracy.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">EOB</a> &gt; T4Wav.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for EOB&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>T4Wav
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>T4Wav Taylor-T4 waveform at 2.5 or 3.0 PN accuracy.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = T4Wav(nu,t,x,phi, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">T4Wav Taylor-T4 waveform at 2.5 or 3.0 PN accuracy.

   [h22, psi22] = T4Wav(nu,t,x,phi)

   [h22, psi22] = T4Wav(nu,t,x,phi, pnorder) specify PN order ('2.5PN' or
   '3PN') 

   [h22, psi22] = T4Wav(nu,t,x,phi, [],addelta) re-define phase to absorb
   the log(x/x0) (if addelta='yes') 
  
   wav = T4Wav(nu,t,x,phi) return a structure with the wave

   Reference(s)
    Boyle et al, XXX YYY Eq. (30),(46).
    Kidder, PRD 77, 044016 (2008), Eq.(79).</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="SetVOutput.html" class="code" title="function vout = SetVOutput( n, varargin )">SetVOutput</a>	SetVOutput Manage variables in output.</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="T4Run.html" class="code" title="function varargout = T4Run(q,r0,Phi0,dt,tmax, varargin)">T4Run</a>	T4Run Taylor-T4 approximant.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = T4Wav(nu,t,x,phi, varargin)</a>
0002 
0003 <span class="comment">%T4Wav Taylor-T4 waveform at 2.5 or 3.0 PN accuracy.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   [h22, psi22] = T4Wav(nu,t,x,phi)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   [h22, psi22] = T4Wav(nu,t,x,phi, pnorder) specify PN order ('2.5PN' or</span>
0008 <span class="comment">%   '3PN')</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   [h22, psi22] = T4Wav(nu,t,x,phi, [],addelta) re-define phase to absorb</span>
0011 <span class="comment">%   the log(x/x0) (if addelta='yes')</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   wav = T4Wav(nu,t,x,phi) return a structure with the wave</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   Reference(s)</span>
0016 <span class="comment">%    Boyle et al, XXX YYY Eq. (30),(46).</span>
0017 <span class="comment">%    Kidder, PRD 77, 044016 (2008), Eq.(79).</span>
0018 <span class="comment">%</span>
0019 
0020 
0021 <span class="comment">% Manage args in</span>
0022 order    = <span class="string">'3pn'</span>;
0023 addelta  = <span class="string">'no'</span>;
0024 
0025 optargs = {order addelta};
0026 na = length(varargin);
0027 <span class="keyword">if</span> (na&gt;2)
0028     error(<span class="string">'too many input args'</span>)
0029 <span class="keyword">end</span>
0030 newvals = cellfun(@(x) ~isempty(x), varargin);
0031 optargs(newvals) = varargin(newvals);
0032 [order addelta] = optargs{:};
0033 
0034 
0035 <span class="comment">% Shorthands</span>
0036 gamma =  0.5772156649015329;  <span class="comment">% Euler constants</span>
0037 pi2   =  pi^2;                  
0038 N22   = -8*nu*sqrt(pi/5.0);      <span class="comment">% The normalization</span>
0039 b     =  2.0;
0040 nu2   = nu^2;
0041 nu3   = nu^3;
0042 
0043 x2    = x.^2;
0044 x3    = x.^2;
0045 x32   = x.^(3/2);
0046 x52   = x.^(5/2);
0047 logx  = log(x);
0048 
0049 
0050 <span class="comment">% Wave at given order</span>
0051 <span class="comment">% TODO: the following can be optimized</span>
0052 <span class="keyword">switch</span> lower(order)
0053     
0054     <span class="keyword">case</span> <span class="string">'2.5pn'</span>
0055     
0056         htilde22 = N22* x.* ( 1-x.*(107/42-55/42*nu) + x32.*2*pi<span class="keyword">...</span>
0057             -(2173/1512 + 1069/216*nu - 2047/1512*nu2).*x2<span class="keyword">...</span>
0058             -x52.*( (107/21 - 34/21*nu)*pi+24*i*nu)   );    
0059     
0060     <span class="keyword">case</span> <span class="string">'3pn'</span>
0061     
0062         htilde22 = N22* x.* ( 1-x.*(107/42-55/42*nu) + x32.*2*pi<span class="keyword">...</span>
0063             - (2173/1512 + 1069/216*nu - 2047/1512*nu2).*x2<span class="keyword">...</span>
0064             - x52.*( (107/21 - 34/21*nu)*pi+24*i*nu) <span class="keyword">...</span>
0065             +  x3.*( 27027409/646800 - 856/105*gamma + 2/3*pi2 <span class="keyword">...</span>
0066             - 1712/105*log(2) -428/105*logx<span class="keyword">...</span>
0067             - (278185/33264-41/96*pi2)*nu -20261/2772*nu2 <span class="keyword">...</span>
0068             + 114635/99792*nu3 + 428/105*i*pi) );
0069     
0070     <span class="keyword">otherwise</span>
0071         
0072         error(<span class="string">' only 2.5PN or 3PN allowed'</span>);
0073         
0074 <span class="keyword">end</span>
0075 
0076 
0077 <span class="comment">% Re-define phase to absorb the log(x/x0)  (if required)</span>
0078 <span class="comment">% Eq.(30) of Boyle et al.</span>
0079 <span class="keyword">if</span> strcmp(lower(addelta),<span class="string">'yes'</span>)
0080     logx0 = 11/18 -2.0/3.0*gamma + 2.0/3.0*log(1.0/(4*b));
0081     delta  = -3*(1-x/8.0).*x32.*(logx-logx0);
0082     phi = phi+delta;            
0083 <span class="keyword">end</span>
0084    
0085 
0086 <span class="comment">% Wave</span>
0087 emitp  = exp(-2*i*phi);
0088 h22    = htilde22 .* emitp;
0089 psi22 = h22/sqrt(24.0);
0090 
0091 
0092 <span class="comment">% Output</span>
0093 varargout = <a href="SetVOutput.html" class="code" title="function vout = SetVOutput( n, varargin )">SetVOutput</a>( nargout, psi22,h22 );
0094 
0095</pre></div>
<hr><address>Generated on Fri 25-Sep-2015 16:20:46 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>